{% extends 'big_data/base.html' %}

{% block title %}
    DashBoard
{% endblock %}


{% block css %}
    <link rel="stylesheet" href="/static/css/dashboard/index.css">
{% endblock %}

{% block js %}
    <script src="/static/js/echarts/dist/echarts.js"></script>
    <script type="text/javascript" src="/static/js/index.js"></script>
{% endblock %}

{% block right_side %}
    <div class="container" id="base_card">
        <div class="row" id="row1">
            <div class="col-md-8" id="pic1">
            </div>

             <script type="text/javascript">
                var avg_sal_every_month = {{ avg_sal_every_month | safe }};
                var month = avg_sal_every_month[0];
                var sal = avg_sal_every_month[1];

                draw_line(month,sal,"pic1","近"+month.length+"个月的业内平均薪水");
            </script>

            <div class="col-md-4 group_card" id="group_stats">
                <div id="avg_sal">
                    <h4>当月业内平均工资</h4>

                </div>
                <div id="offer_change">
                    <div>
                        <h4>上月同比增长offer数率</h4>
                        <h4 id="percent"></h4>
                    </div>

                    <script type="text/javascript">
                        var percent = {{ offer_change.0 }};
                        percent = Math.round(percent);

                        h4 = document.getElementById("percent");

                        if(percent >=0)
                        {
                            h4.innerHTML = "+"+percent+"%";
                            h4.style.color = '#5ac146';
                        }
                        else
                        {
                            h4.innerHTML = "-"+percent+"%";
                            h4.style.color = "red";
                        }

                    </script>

                    <div>
                        <div class="small_card" id="small_card1">
                            <h4>{{ offer_change.1 }}</h4>
                            <h5>今日offer数量</h5>
                        </div>
                        <div class="small_card" id="small_card2">
                            <h4>{{ offer_change.2 }}</h4>
                            <h5>上月offer数量</h5>
                        </div>
                    </div>

                </div>
            </div>
        </div>

         <script type="text/javascript">
                        var avg_sal_this_month = {{ avg_sal_this_month | safe }};
                        var avg_sal = avg_sal_this_month[1];

                        var sum = 0;
                        for(var i=0;i<avg_sal.length;i++)
                        {
                            sum += avg_sal[i];
                        }

                        var result = Math.round(sum/avg_sal.length*1000000)/100;


                        var h4 = document.createElement("h4");
                        h4.innerHTML = "¥"+result;
                        h4.id="avg_sal_h4"

                        var div = document.getElementById("avg_sal");
                        div.appendChild(h4);
                    </script>


        <div class="row" id="row2">
            <div class="card">
                <h4>薪水前5的职业</h4>
                <table class="table">
                    <thead>
                      <tr>
                          <th><i class="fa fa-tag">ID</th>
                          <th><i class="fa fa-link"></i>职业名</th>
                          <th><i class="fa fa-rmb"></i>薪水(万/月)</th>
                          <th><i class="fa fa-suitcase"></i>Offer数量</th>
                      </tr>
                    </thead>
                    <tbody id="tbody1">
                    <script type="text/javascript">
                                var top5_sal_result = {{ top5_sal_result | safe }};

                                for (var i=1;i<=top5_sal_result[0].length;i++)
                                {
                                    var tbody = document.getElementById("tbody1");
                                    var tr = document.createElement("tr");

                                    tr.id = "top5_sal_"+i+"_tr";
                                    tbody.appendChild(tr);

                                    for(var j =0;j<4;j++)
                                    {
                                        var tr = document.getElementById("top5_sal_"+i+"_tr");
                                        var td = document.createElement("td");

                                        if(j == 0)
                                        {
                                            var content = i;
                                        }
                                        else
                                        {
                                            var content = top5_sal_result[j-1][i-1];
                                        }

                                        td.innerHTML=content;
                                        tr.appendChild(td);
                                    }

                                }
                            </script>

                    </tbody>
                </table>
            </div>
        </div>

        <div class="row" id="row3">
            <div class="card">
                <h4>一周内Offer增量前5的职业</h4>
                <table class="table ">
                    <thead>
                      <tr>
                          <th><i class="fa fa-tag">ID</th>
                          <th><i class="fa fa-link"></i>职业名</th>
                          <th><i class="fa fa-suitcase"></i>offer增量</th>
                          <th><i class="fa fa-suitcase"></i>Offer数量</th>
                      </tr>
                    </thead>
                    <tbody id="tbody2">
                    <script type="text/javascript">
                                var top5_sal_result = {{ top5_offer_result | safe }};

                                for (var i=1;i<=top5_sal_result[0].length;i++)
                                {
                                    var tbody = document.getElementById("tbody2");
                                    var tr = document.createElement("tr");

                                    tr.id = "top5_offer_"+i+"_tr";
                                    tbody.appendChild(tr);

                                    for(var j =0;j<4;j++)
                                    {
                                        var tr = document.getElementById("top5_offer_"+i+"_tr");
                                        var td = document.createElement("td");

                                        if(j == 0)
                                        {
                                            var content = i;
                                        }
                                        else
                                        {
                                            var content = top5_sal_result[j-1][i-1];
                                        }

                                        td.innerHTML=content;
                                        tr.appendChild(td);
                                    }

                                }
                            </script>
                    </tbody>
                </table>
            </div>
        </div>

    </div>
{% endblock %}
